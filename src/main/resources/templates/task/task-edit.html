<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="/partials/partials :: head('Edit Task')"></head>
<body>

<div id="wrapper">
  <nav th:replace="/partials/partials :: nav"></nav>
  <header th:replace="/partials/partials :: header('Edit Task')"></header>

  <main class="container">
    <h2>Create a Task</h2>
    <form th:method="POST" th:action="@{|/task/edit/${task.id}|}" th:object="${task}">

      <div class="form-group mb-3">
        <label for="title">Title</label>
        <input th:field="*{title}" type="text" name="title" id="title" class="form-control">
      </div>

      <div class="form-group mb-3">
        <label for="body">Description</label>
        <textarea th:field="*{description}" name="body" id="body" class="form-control"></textarea>
      </div>

      <!-- Checkbox for scheduling -->
      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="scheduleCheckbox" th:checked="${task.dateScheduled != null}">
        <label class="form-check-label" for="scheduleCheckbox">Schedule Task</label>
      </div>

      <!-- DateScheduled input (initially hidden) -->
      <div id="dateScheduledField" th:if="${task.dateScheduled != null}">
        <div class="form-group mb-3">
          <label for="dateScheduled">Scheduled Date</label>
          <input th:field="*{dateScheduled}" type="date" name="dateScheduled" id="dateScheduled" class="form-control">
        </div>
      </div>

      <!--   for category  -->
      <div class="form-group mb-3">
        <label for="category">Category</label>
        <select th:field="*{category.id}" class="form-control" id="category">
          <option th:each="category : ${categories}" th:value="${category.id}" th:text="${category.title}"></option>
        </select>
      </div>


      <button class="btn btn-dark" type="submit">Submit</button>
    </form>
  </main>

  <footer th:replace="/partials/partials :: footer"></footer>
</div>

<th:block th:replace="/partials/partials :: scripts"></th:block>

<script>

  const scheduleCheckbox = document.querySelector("#scheduleCheckbox");
  const dateScheduledField = document.querySelector("#dateScheduledField");

  scheduleCheckbox.addEventListener("change", function() {
    if (scheduleCheckbox.checked) {
      dateScheduledField.style.display = "block";
    } else {
      dateScheduledField.style.display = "none";
    }
  });

</script>
</body>
</html>